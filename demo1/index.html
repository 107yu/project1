<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .box .box1{
            width:700px;
            height:400px;
            border:2px solid #f99;
            display:flex;
            flex-wrap:wrap;
        }
        img{
            width:100px;
            height:100px;
            margin:10px;
        }
    
    
    </style>
</head>
<body>
    <div class="box"></div>
    <div class="box1"></div>
    <script>
        let box=document.querySelector(".box")
        let box1=document.querySelector(".box1")
        let imgs=["./img/1.jpg","http://img95.699pic.com/photo/40146/1836.gif_wh300.gif","./img/2.jpg","./img/3.jpg"]
        //串行  同步  //一个完成之后才能另外一个
        function load(url,box){
            return new Promise((resolve,reject)=>{
                let img=new Image()
               
                img.onload=()=>{
                    resolve(img)
                }
                img.onerror=()=>{
                    reject(new Error("erroe"))
                }
                img.src=url;
            })

        }
        //串行
        async function loading(){             //1个异步函数
            for(let i=0;i<imgs.length;i++){
                let img=await load(imgs[i])  //await load(imgs[i])的值为resolve返回的值
                box.appendChild(img)
            }
        }

        //并行  异步
        function loading1(){
            imgs.forEach(async item=>{           //5 个异步函数
                let img=await load(item)
                console.log(1)
                console.log(img)
                box1.appendChild(img)

            })
        }
        loading(imgs)
        // loading1(imgs)
    function* loadSync(){
         for(let i=0;len=imgs.length,i<len;i++){//同步加载   for in表示同步
             let img=yield load(imgs[i])  //load函数是一个promise对象，会有链式调用 ，
                                        //then 后面接收的值就是resolve里面传的值
             box.appendChild(img)
         }
     }
     //自动执行
     function run(fun){
         let f=fun();//迭代器
         function fn(value){
             let res=f.next(value) //开始执行
             if(!res.done){  //判断状态  为false继续执行
                 if(res.value.then){    //判断是否是一个promise对象
                     res.value.then(res=>{
                         fn(res)
                     })
                 }else{
                     fn(res.value) //不是promise对象就直接返回这个值
                 }
             }
         }
         fn()

     }
    //  run(loadSync)
    

    
    </script>
</body>
</html>